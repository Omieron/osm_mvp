<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dinamik 3D Bina Haritası</title>
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">

    <!-- MapLibre GL CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/maplibre-gl@latest/dist/maplibre-gl.css">
    <script src="https://cdn.jsdelivr.net/npm/maplibre-gl@latest/dist/maplibre-gl.js"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        #legend span {
            display: inline-block;
            margin-top: 3px;
            border-radius: 3px;
        }
    </style>
</head>

<body>

    <div id="map"></div>

    <div id="legend" style="position: absolute; bottom: 10px; left: 10px; background: white; padding: 10px; border-radius: 5px;">
        <strong>Bina Türleri ve Renkler:</strong><br>
        <span style="background-color:#0077b6; color: white; padding: 2px 5px;">Ofis & Dükkan</span><br>
        <span style="background-color:#9b5de5; color: white; padding: 2px 5px;">İbadethane</span><br>
        <span style="background-color:#2a9d8f; color: white; padding: 2px 5px;">Konut</span><br>
        <span style="background-color:#d90429; color: white; padding: 2px 5px;">Kamu Binaları</span><br>
        <span style="background-color:#ff8800; color: white; padding: 2px 5px;">AVM</span><br>
        <span style="background-color:#aaa; color: white; padding: 2px 5px;">Bilinmeyen</span><br>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const map = new maplibregl.Map({
                container: "map",
                style: "https://api.maptiler.com/maps/streets-v2/style.json?key=apim",
                center: [28.9789, 41.0103], // İstanbul örneği
                zoom: 15,
                pitch: 45, // 3D açıyı etkinleştir
                bearing: -17.6
            });

            map.on("load", () => {
                map.addSource("openmaptiles", {
                    type: "vector",
                    url: "https://api.maptiler.com/tiles/v3/tiles.json?key=apim"
                });
                console.log(map);
                map.addLayer({
                    id: "3d-buildings",
                    source: "openmaptiles",
                    "source-layer": "building",
                    type: "fill-extrusion",
                    paint: {
                        "fill-extrusion-color": [
                            'match',
                            ['get', 'building_type'],
                            'house', '#808080',   // Evler gri
                            'hospital', '#FF69B4', // Hastaneler pembe
                            'shop', '#0000FF',     // Dükkanlar mavi
                            'mall', '#FFA500',     // AVM'ler turuncu
                            'park', '#008000',     // Parklar yeşil
                            '#008000' // Varsayılan renk
                        ],
                        "fill-extrusion-height": ["get", "render_height"],
                        "fill-extrusion-base": ["get", "render_min_height"],
                        "fill-extrusion-opacity": 0.6
                    }
                });
            });
        });
    </script>

</body>

</html>